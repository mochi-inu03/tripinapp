<h1 style="color: #0288d1; text-align: center;"><%= @spot.title %></h1>

<!-- ç”»åƒ -->
<% if @spot.image.attached? %>
  <div style="margin-bottom: 20px; text-align: center;">
    <%= image_tag @spot.image, style: "max-width: 90%; height: auto; border-radius: 12px;" %>
  </div>
<% end %>

<!-- æŠ•ç¨¿æ—¥ãƒ»æŠ•ç¨¿è€… -->
<div style="text-align: center; color: #777; margin-bottom: 10px;">
  ğŸ—“ <%= @spot.created_at.strftime("%Yå¹´%mæœˆ%dæ—¥") %>ã€€
  ğŸ‘¤ <%= @spot.user.nickname %>
</div>

<!-- èª¬æ˜ -->
<p style="padding: 0 20px; font-size: 16px; line-height: 1.6; margin-bottom: 20px;">
  <%= simple_format(@spot.description) %>
</p>

<!-- ä½æ‰€ -->
<% if @spot.latitude.present? && @spot.longitude.present? %>
  <p style="text-align: center; margin-bottom: 10px;">
    ğŸ“ <a href="https://www.google.com/maps?q=<%= @spot.latitude %>,<%= @spot.longitude %>" target="_blank">
      <%= @spot.address %>
    </a>
  </p>

  <!-- Google Map è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
  <div id="map" style="width: 100%; height: 400px; margin: 20px 0; border: 1px solid #ccc;"></div>
<% else %>
  <p style="text-align: center;">ğŸ“ <%= @spot.address %></p>
<% end %>

<!-- ã‚«ãƒ†ã‚´ãƒª -->
<% if @spot.category_id != 1 %>
  <p style="text-align: center;">ğŸ“‚ ã‚«ãƒ†ã‚´ãƒª: <%= Category.find(@spot.category_id).name %></p>
<% end %>

<!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
<div style="text-align: center; margin-top: 40px;">
  <%= link_to "â† ä¸€è¦§ã«æˆ»ã‚‹", spots_path, class: "spot-detail-link", style: "color: #0288d1; text-decoration: none;" %>
</div>

<div class="button-group">
  <% if @spot.user == current_user %>
    <%= button_to 'å‰Šé™¤ã™ã‚‹', spot_path(@spot), method: :delete, data: { confirm: 'æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ' }, class: 'delete-button' %>
  <% end %>

  <% if @spot.user == current_user %>
    <%= link_to 'ç·¨é›†ã™ã‚‹', edit_spot_path(@spot), class: 'edit-button' %>
  <% end %>
</div>

<%# --- Google Mapç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ --- %>
<% if @spot.latitude.present? && @spot.longitude.present? %>
  <script src="https://maps.googleapis.com/maps/api/js?key=<%= Rails.application.credentials.dig(:google_maps, :api_key) %>&callback=initShowMap" async defer></script>

  <script>
    function initShowMap() {
      const mapElement = document.getElementById('map');
      if (!mapElement) return;

      const lat = <%= @spot.latitude %>;
      const lng = <%= @spot.longitude %>;

      const map = new google.maps.Map(mapElement, {
        center: { lat: lat, lng: lng },
        zoom: 15
      });

      new google.maps.Marker({
        position: { lat: lat, lng: lng },
        map: map,
        title: "<%= j @spot.title %>"
      });
    }
  </script>
<% end %>
